---
---
<div class="page" id="page-rsvp">
  <div class="page-inner" style="max-width:700px;">
    <p class="section-label">Join Us</p>
    <h2 class="section-title">RSVP</h2>
    <div class="section-divider"></div>

    <div class="rsvp-wrapper">
      <div class="rsvp-progress" id="rsvpProgress">
        <div class="rsvp-progress-dot active"></div>
        <div class="rsvp-progress-dot"></div>
        <div class="rsvp-progress-dot"></div>
        <div class="rsvp-progress-dot"></div>
        <div class="rsvp-progress-dot"></div>
      </div>

      <!-- STEP 1: LOOKUP -->
      <div class="rsvp-step active" id="step1">
        <h3>Find Your Invitation</h3>
        <p class="step-sub">Enter your name as it appears on your invitation</p>
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">First Name *</label>
            <input type="text" class="form-input" id="lookupFirst" placeholder="First name" onkeydown="if(event.key==='Enter'){event.preventDefault();lookupGuest();}">
          </div>
          <div class="form-group">
            <label class="form-label">Last Name *</label>
            <input type="text" class="form-input" id="lookupLast" placeholder="Last name" onkeydown="if(event.key==='Enter'){event.preventDefault();lookupGuest();}">
          </div>
        </div>
        <div class="lookup-error" id="lookupError">
          We couldn't find that name on our guest list. Please try the name as it appears on your invitation, or reach out to Chang &amp; John directly.
        </div>
        <div class="rsvp-nav">
          <button class="rsvp-nav-btn next" onclick="lookupGuest()">Find My Invitation</button>
        </div>
      </div>

      <!-- STEP 2: PARTY & ATTENDANCE -->
      <div class="rsvp-step" id="step2">
        <h3>Your Party</h3>
        <p class="step-sub">Let us know who's coming and share their contact details</p>
        <div class="party-summary" id="partySummary"></div>
        <div id="guestCards"></div>
        <div class="rsvp-nav">
          <button class="rsvp-nav-btn back" onclick="prevStep()">Back</button>
          <button class="rsvp-nav-btn next" id="step2Next" onclick="handleStep2Next()" disabled>Continue</button>
        </div>
      </div>

      <!-- STEP 3: EVENTS -->
      <div class="rsvp-step" id="step3">
        <h3>Which Events Will You Join?</h3>
        <p class="step-sub">Check all that your party plans to attend</p>
        <div class="event-check-list">
          <label class="event-check locked">
            <input type="checkbox" checked disabled>
            <div class="check-box">&#10003;</div>
            <div class="check-label">
              <div class="check-name">&#128146; Wedding Ceremony &amp; Reception</div>
              <div class="check-detail">Wednesday, Sep 2 &middot; 4:45 PM &ndash; Late</div>
              <div class="locked-note">You're coming &mdash; this one's locked in!</div>
            </div>
          </label>
          <label class="event-check" id="explorationCheck">
            <input type="checkbox" name="events" value="exploration" onchange="toggleGrape(this)">
            <div class="check-box">&#10003;</div>
            <div class="check-label">
              <div class="check-name">&#127815; Exploration Time</div>
              <div class="check-detail">Tuesday, Sep 1 &middot; 10:30 AM</div>
            </div>
          </label>
          <div class="grape-pref" id="grapePref">
            <label class="form-label">What's your preference for Tuesday?</label>
            <label class="grape-option"><input type="radio" name="grapePref" value="definitely"><span class="grape-radio"></span><span class="grape-option-text">&#127815; Definitely joining Grape Stomping (&euro;50&ndash;90/pp TBD)</span></label>
            <label class="grape-option"><input type="radio" name="grapePref" value="cost-dependent"><span class="grape-radio"></span><span class="grape-option-text">&#128176; Interested, but want final cost first</span></label>
            <label class="grape-option"><input type="radio" name="grapePref" value="separate-tour"><span class="grape-radio"></span><span class="grape-option-text">&#128203; Organize a separate tour with our planner</span></label>
            <label class="grape-option"><input type="radio" name="grapePref" value="self-explore"><span class="grape-radio"></span><span class="grape-option-text">&#128506; Exploring on my own</span></label>
            <label class="grape-option"><input type="radio" name="grapePref" value="unsure"><span class="grape-radio"></span><span class="grape-option-text">&#129300; Not sure yet</span></label>
          </div>
          <label class="event-check">
            <input type="checkbox" name="events" value="welcome">
            <div class="check-box">&#10003;</div>
            <div class="check-label">
              <div class="check-name">&#129346; Welcome Pizza Party</div>
              <div class="check-detail">Tuesday, Sep 1 &middot; 7:30 PM</div>
            </div>
          </label>
          <label class="event-check">
            <input type="checkbox" name="events" value="brunch">
            <div class="check-box">&#10003;</div>
            <div class="check-label">
              <div class="check-name">&#129374; Post-Wedding Brunch</div>
              <div class="check-detail">Thursday, Sep 3 &middot; 10:30 AM</div>
            </div>
          </label>
          <label class="event-check">
            <input type="checkbox" name="events" value="beach">
            <div class="check-box">&#10003;</div>
            <div class="check-label">
              <div class="check-name">&#127958; Beach Day or Pool Party</div>
              <div class="check-detail">Thursday, Sep 3 &middot; 2:00 PM</div>
            </div>
          </label>
          <label class="event-check">
            <input type="checkbox" name="events" value="farewell">
            <div class="check-box">&#10003;</div>
            <div class="check-label">
              <div class="check-name">&#127869; Farewell Dinner</div>
              <div class="check-detail">Thursday, Sep 3 &middot; 7:00 PM</div>
            </div>
          </label>
        </div>
        <div class="rsvp-nav">
          <button class="rsvp-nav-btn back" onclick="prevStep()">Back</button>
          <button class="rsvp-nav-btn next" onclick="nextStep()">Continue</button>
        </div>
      </div>

      <!-- STEP 4: TRAVEL & STAY -->
      <div class="rsvp-step" id="step4">
        <h3>Travel &amp; Stay</h3>
        <p class="step-sub">Help us coordinate logistics for your group</p>
        <div class="form-group">
          <label class="form-label">Accommodation Preference</label>
          <select class="form-select" id="accommodation">
            <option value="">Select...</option>
            <option value="palazzo">Stay at Palazzo Mannocchi (&euro;280 in cash per person 12 years+)</option>
            <option value="hotel">Nearby hotel or Airbnb (we'll help coordinate with our planner)</option>
            <option value="own">I'll find my own</option>
          </select>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Arrival Date</label>
            <select class="form-select" id="arrivalDate">
              <option value="">Select...</option>
              <option value="aug31">Sunday, August 31</option>
              <option value="sep1">Monday, September 1</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">Departure Date</label>
            <select class="form-select" id="departureDate">
              <option value="">Select...</option>
              <option value="sep3">Thursday, September 3</option>
              <option value="sep4">Friday, September 4</option>
            </select>
          </div>
        </div>
        <div class="form-group">
          <label class="form-label">How are you getting to Petritoli?</label>
          <select class="form-select" id="transportTo">
            <option value="">Select...</option>
            <option value="rental-car">Renting a car</option>
            <option value="main-shuttle">Main shuttle from Rome Tiburtina (~2PM Sunday, Aug 31)</option>
            <option value="other-transfer">Transfer from another location [we'll help organize to lower cost &mdash; at your own expense]</option>
            <option value="own">I'll figure it out myself</option>
            <option value="unsure">Not sure yet</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">If you need a transfer, where from and what time?</label>
          <input type="text" class="form-input" id="transferToDetails" placeholder="e.g. Rome Fiumicino, arriving 11AM on Sunday Aug 31">
        </div>
        <div class="form-group">
          <label class="form-label">How are you leaving Petritoli?</label>
          <select class="form-select" id="transportFrom">
            <option value="">Select...</option>
            <option value="rental-car">Driving myself (rental car)</option>
            <option value="main-shuttle">Main shuttle back to Rome (~11AM Friday, Sep 4)</option>
            <option value="other-transfer">Shuttle to a different location [we'll help organize to lower cost &mdash; at your own expense]</option>
            <option value="own">I'll figure it out myself</option>
            <option value="unsure">Not sure yet</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label">If you want a different departure shuttle, where to and when?</label>
          <input type="text" class="form-input" id="transferFromDetails" placeholder="e.g. Bologna airport, Friday Sep 4 afternoon">
        </div>
        <div class="rsvp-nav">
          <button class="rsvp-nav-btn back" onclick="prevStep()">Back</button>
          <button class="rsvp-nav-btn next" onclick="nextStep()">Continue</button>
        </div>
      </div>

      <!-- STEP 5: FINAL -->
      <div class="rsvp-step" id="step5">
        <h3>Almost There!</h3>
        <p class="step-sub">Any last details to help us plan the perfect week</p>
        <div class="form-group">
          <label class="form-label">Special needs or requests for accommodations / activities</label>
          <textarea class="form-textarea" id="specialNeeds" placeholder="e.g. need a ground-floor room, mobility considerations, interested in a specific tour..."></textarea>
        </div>
        <div class="form-group">
          <label class="form-label">Song requests, questions, or just leave a sweet note &#128155;</label>
          <textarea class="form-textarea" id="sweetNote" placeholder="What song will get you on the dance floor?"></textarea>
        </div>
        <div class="rsvp-nav">
          <button class="rsvp-nav-btn back" onclick="prevStep()">Back</button>
          <button class="rsvp-nav-btn next" onclick="submitRSVP()" id="submitBtn">Submit RSVP</button>
        </div>
      </div>

      <!-- DECLINE SCREEN -->
      <div class="rsvp-decline" id="rsvpDecline">
        <div style="font-size:3.5rem; margin-bottom:24px;">&#128140;</div>
        <h3>We'll Miss You</h3>
        <p>We completely understand. Thank you for letting us know &mdash; you'll be in our hearts on the day.</p>
        <div class="form-group" style="margin-top:28px; text-align:left;">
          <label class="form-label">Leave us a message?</label>
          <textarea class="form-textarea" id="declineNote" placeholder="We'd love to hear from you..."></textarea>
        </div>
        <div class="rsvp-nav">
          <button class="rsvp-nav-btn next" onclick="submitDeclineMessage()">Send Message</button>
        </div>
      </div>

      <!-- SUCCESS -->
      <div class="rsvp-success" id="rsvpSuccess">
        <div class="success-icon">&#127881;</div>
        <h3>You're Coming to Italy!</h3>
        <p>We're so excited to celebrate with you. We'll be in touch with more details as the big day approaches.</p>
      </div>

      <!-- DECLINE SENT -->
      <div class="rsvp-success" id="rsvpDeclineSent">
        <div class="success-icon">&#128155;</div>
        <h3>Message Sent</h3>
        <p>Thank you for your kind words. We'll miss you!</p>
      </div>
    </div>
  </div>
</div>
